<% content_for :head do%>
    <title>User列表</title>
<% end%>
<!--datatables-->
<div class="row">
    <div class="col-lg-12">
        <button id="mutipleDeleteBtn" class="btn btn-danger btn-group-sm">删除已标记项目</button>
        <div class="panel panel-default">
            <div class="panel-heading">
                <!--这张表(plural_table_name)的复数名称的标题化(内部单词首字母大写)-->
                Users列表
                <%= link_to '新建 User', new_user_path,style:"float:right;color:white;margin-top: -2px;line-height:1;",class:'btn btn-sm btn-success' %>
            </div>
            <div class="panel-body">
                <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                </table>
            </div>
        </div>
    </div>
</div>

<!--初始化dataTables-->
<script>

    
    $(document).ready(function () {
        //todo:仿照rails的伪造方法来发起delete request,以及此处没有重写delete 的路由而随便传入了id,当然controller需要配合做出相应改动
        var urls={
            query:'<%= users_path%>/index_ajax',
            delete:'<%= users_path%>/2333'
        };
        var data ={
            "columns": [  //todo:根据model里边的字段来设置columns,然后需要加上一些批量操作以及跳转链接
                {"title":"<input type='checkbox' id='dataTableSelectAll' /><span style='user-select:none;cursor:pointer;' onclick='$(this).prev().click();'>全选本页</span>","className":"dataTableSelection","orderable":false,"searchable":false,"data":"id",render:function(id){
                    return "<input type='checkbox' class='itemSelector' name='item' item-id='"+id+"' />";
                }}
                ,{"title": "id", "data": "id"}
                                ,{"title": "username", "data": "username"}
                                ,{"title": "password", "data": "password"}
                                ,{"title": "created_at", "data": "created_at"}
                ,{"title": "updated_at", "data": "updated_at"}
                ,{"title":"operations","orderable":false,"searchable":false,"data":"id",render:function(id){
                    linkHref='<%= users_path%>/'+id;
                    look="<a class='btn btn-sm btn-default' href="+linkHref+" style='margin-right:7px;'>查看详情</a>";
                    del="<a data-confirm='确定删除?' rel='nofollow' data-method='delete' href="+linkHref+" class='btn btn-danger btn-sm'>删除</a>";
                    return look+del;
                }}
            ]
        };
        $.MM_dataTable("#dataTables-example",data,urls);
    });
</script>
<br>

